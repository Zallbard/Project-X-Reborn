;------------------------------------------------------------------------------
;GLA Demo Trap
Object GLADemoTrap_DemoTruck

; *** ART Parameters ***
SelectPortrait          SSHideBomb_L
ButtonImage             SSHideBomb
Draw  W3DModelDraw ModuleTag_01
OkToChangeModelColor  Yes
DefaultConditionState
Model          UVDmTrck_M
Animation      UVDmTrck_M.UVDmTrck_M
AnimationMode  ONCE
End
AliasConditionState  DAMAGED
AliasConditionState  REALLYDAMAGED
AliasConditionState  RUBBLE
AliasConditionState  NIGHT
AliasConditionState  SNOW
AliasConditionState  NIGHT SNOW
AliasConditionState  NIGHT DAMAGED
AliasConditionState  SNOW DAMAGED
AliasConditionState  NIGHT SNOW DAMAGED
AliasConditionState  NIGHT REALLYDAMAGED RUBBLE
AliasConditionState  SNOW REALLYDAMAGED RUBBLE
AliasConditionState  NIGHT SNOW REALLYDAMAGED RUBBLE

;**************************************************************************************************************************
;This block handles every possible case with construction process, selling process, awaiting construction, and sold states
;for this draw module
ConditionState        AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
Model               UVDmTrck_M
Flags               ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
End
AliasConditionState   AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED NIGHT
AliasConditionState   AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED SNOW
AliasConditionState   AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED NIGHT SNOW

ConditionState        AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED DAMAGED
Model               UVDmTrck_M
Flags               ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
End
AliasConditionState   AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED DAMAGED NIGHT
AliasConditionState   AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED DAMAGED SNOW
AliasConditionState   AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED DAMAGED NIGHT SNOW

ConditionState        AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED REALLYDAMAGED
Model               UVDmTrck_M
Flags               ADJUST_HEIGHT_BY_CONSTRUCTION_PERCENT
End
AliasConditionState   AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED REALLYDAMAGED NIGHT
AliasConditionState   AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED REALLYDAMAGED SNOW
AliasConditionState   AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED REALLYDAMAGED NIGHT SNOW

ConditionState        AWAITING_CONSTRUCTION
Model               NONE
End
AliasConditionState   AWAITING_CONSTRUCTION DAMAGED
AliasConditionState   AWAITING_CONSTRUCTION REALLYDAMAGED
AliasConditionState   AWAITING_CONSTRUCTION NIGHT
AliasConditionState   AWAITING_CONSTRUCTION NIGHT DAMAGED
AliasConditionState   AWAITING_CONSTRUCTION NIGHT REALLYDAMAGED
AliasConditionState   AWAITING_CONSTRUCTION NIGHT SNOW
AliasConditionState   AWAITING_CONSTRUCTION NIGHT SNOW DAMAGED
AliasConditionState   AWAITING_CONSTRUCTION NIGHT SNOW REALLYDAMAGED
AliasConditionState   SOLD DAMAGED
AliasConditionState   SOLD REALLYDAMAGED
AliasConditionState   SOLD NIGHT
AliasConditionState   SOLD NIGHT DAMAGED
AliasConditionState   SOLD NIGHT REALLYDAMAGED
AliasConditionState   SOLD NIGHT SNOW
AliasConditionState   SOLD NIGHT SNOW DAMAGED
AliasConditionState   SOLD NIGHT SNOW REALLYDAMAGED
;**************************************************************************************************************************


End

; ------------ construction-zone fence -----------------
Draw  W3DModelDraw ModuleTag_056
AnimationsRequirePower  No
DefaultConditionState
Model            None
HideSubObject    CYLINDER01
TransitionKey    DOWN_DEFAULT
End
AliasConditionState  NIGHT
AliasConditionState  SNOW
AliasConditionState  SNOW NIGHT

ConditionState     AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
Model            UBDmTrp_AB
Animation        UBDmTrp_AB.UBDmTrp_AB
AnimationMode    MANUAL
Flags            START_FRAME_LAST
TransitionKey    UP_DAY
End
AliasConditionState  NIGHT AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED

ConditionState     SNOW AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED
Model            UBDmTrp_ABS
Animation        UBDmTrp_ABS.UBDmTrp_ABS
AnimationMode    MANUAL
Flags            START_FRAME_LAST
TransitionKey    UP_SNOW
End
AliasConditionState  SNOW NIGHT AWAITING_CONSTRUCTION PARTIALLY_CONSTRUCTED ACTIVELY_BEING_CONSTRUCTED

TransitionState    DOWN_DEFAULT UP_DAY
Model            UBDmTrp_AB
Animation        UBDmTrp_AB.UBDmTrp_AB
AnimationMode    ONCE
AnimationSpeedFactorRange  1.0 1.0
Flags            START_FRAME_FIRST
End
TransitionState    DOWN_DEFAULT UP_SNOW
Model            UBDmTrp_ABS
Animation        UBDmTrp_ABS.UBDmTrp_ABS
AnimationMode    ONCE
AnimationSpeedFactorRange  1.0 1.0
Flags            START_FRAME_FIRST
End
TransitionState    UP_DAY DOWN_DEFAULT
Model            UBDmTrp_AB
Animation        UBDmTrp_AB.UBDmTrp_AB
AnimationMode    ONCE_BACKWARDS
AnimationSpeedFactorRange  2.0 2.0   ; play teardown animations more quickly
Flags            START_FRAME_LAST
End
TransitionState    UP_SNOW DOWN_DEFAULT
Model            UBDmTrp_ABS
Animation        UBDmTrp_ABS.UBDmTrp_ABS
AnimationMode    ONCE_BACKWARDS
AnimationSpeedFactorRange  2.0 2.0   ; play teardown animations more quickly
Flags            START_FRAME_LAST
End
End

; ------------ under-construction scaffolding -----------------
Draw  W3DModelDraw ModuleTag_066
AnimationsRequirePower  No
MinLODRequired  MEDIUM

DefaultConditionState
Model            None
TransitionKey    DOWN_DEFAULT
End
AliasConditionState  NIGHT
AliasConditionState  SNOW
AliasConditionState  SNOW NIGHT

ConditionState     PARTIALLY_CONSTRUCTED
Model            UBDmTrp_SC
Animation        UBDmTrp_SC.UBDmTrp_SC
AnimationMode    MANUAL
Flags            START_FRAME_LAST
TransitionKey    UP_DAY
End
AliasConditionState  NIGHT PARTIALLY_CONSTRUCTED

ConditionState     SNOW PARTIALLY_CONSTRUCTED
Model            UBDmTrp_SCS
Animation        UBDmTrp_SCS.UBDmTrp_SCS
AnimationMode    MANUAL
Flags            START_FRAME_LAST
TransitionKey    UP_SNOW
End
AliasConditionState  SNOW NIGHT PARTIALLY_CONSTRUCTED

TransitionState    DOWN_DEFAULT UP_DAY
Model            UBDmTrp_SC
Animation        UBDmTrp_SC.UBDmTrp_SC
AnimationMode    ONCE
AnimationSpeedFactorRange  1.0 1.0
Flags            START_FRAME_FIRST
End
TransitionState    DOWN_DEFAULT UP_SNOW
Model            UBDmTrp_SCS
Animation        UBDmTrp_SCS.UBDmTrp_SCS
AnimationMode    ONCE
AnimationSpeedFactorRange  1.0 1.0
Flags            START_FRAME_FIRST
End
TransitionState    UP_DAY DOWN_DEFAULT
Model            UBDmTrp_SC
Animation        UBDmTrp_SC.UBDmTrp_SC
AnimationMode    ONCE_BACKWARDS
AnimationSpeedFactorRange  2.0 2.0   ; play teardown animations more quickly
Flags            START_FRAME_LAST
End
TransitionState    UP_SNOW DOWN_DEFAULT
Model            UBDmTrp_SCS
Animation        UBDmTrp_SCS.UBDmTrp_SCS
AnimationMode    ONCE_BACKWARDS
AnimationSpeedFactorRange  2.0 2.0   ; play teardown animations more quickly
Flags            START_FRAME_LAST
End
End

Draw  W3DModelDraw ModuleTag_PickBox01

DefaultConditionState
Model          UBDmTrpPB
End

End

; ***DESIGN parameters ***
DisplayName       OBJECT:DemoTrap
Side  GLA
EditorSorting  STRUCTURE
TransportSlotCount  1                 ;how many "slots" we take in a transport (0 == not transportable)

WeaponSet
;The weapon set is used to determine detonation mode
Conditions  None
Weapon  PRIMARY    DummyWeapon ;Used for mode matching only (when to detonate)
Weapon  SECONDARY  DummyWeapon ;Used for mode matching only (when to detonate)
Weapon  TERTIARY   DummyWeapon ;Used for mode matching only (when to detonate)
AutoChooseSources  PRIMARY   NONE
AutoChooseSources  SECONDARY NONE
AutoChooseSources  TERTIARY  NONE
End

ArmorSet
Conditions       None
Armor            DemoTruckTrapStructureArmor
DamageFX         DefaultDamageFX ; Too small for normal building FX, but if we do make dedicated one it should be silent
End

VisionRange  50.0
ShroudClearingRange  50.0

BuildCost  200
BuildTime  4.0          ;in seconds
CrushableLevel          0  ;What am I?:        0  for infantry, 1  for trees, 2  general vehicles
CommandSet     GLADemoTrapNoSellCommandSet


; *** AUDIO Parameters ***
VoiceSelect  UndergroundGeneratorSelect
SoundOnDamaged         NoSound
SoundOnReallyDamaged   NoSound
SoundStealthOn         NoSound
SoundStealthOff        NoSound

UnitSpecificSounds
UnderConstruction      UnderConstructionLoop
End


; *** ENGINEERING Parameters ***
RadarPriority  UNIT
KindOf  PRELOAD SELECTABLE CAN_ATTACK CAN_CAST_REFLECTIONS IMMOBILE DEMOTRAP SCORE CAN_SEE_THROUGH_STRUCTURE SALVAGER

Body  ActiveBody ModuleTag_02
MaxHealth        100.0
InitialHealth    100.0
End

ExperienceValue      20 20 20 20  ; Experience point value at each level

Behavior  AIUpdateInterface ModuleTag_03
AutoAcquireEnemiesWhenIdle  No
End

Behavior  PhysicsBehavior ModuleTag_04
Mass  30.0
End

Behavior  StealthUpdate ModuleTag_043
StealthDelay  500 ; msec
StealthForbiddenConditions  NONE
FriendlyOpacityMin  100.0%
OrderIdleEnemiesToAttackMeUponReveal   Yes
End

Behavior  DemoTrapUpdate ModuleTag_044
DefaultProximityMode       Yes       ;If yes, defaults to proximity mode, otherwise defaults to manual.
DetonationWeaponSlot       PRIMARY   ;The slot the weapon is in when it detonates.
ProximityModeWeaponSlot    SECONDARY ;The slot proximity mode is determined by (bogus weapon)
ManualModeWeaponSlot       TERTIARY  ;The slot manual mode is determined by (bogus weapon)
TriggerDetonationRange     30.0      ;Detonation range when in proximity mode (and must be on ground)
IgnoreTargetTypes          PROJECTILE UNATTACKABLE NO_COLLIDE
AutoDetonationWithFriendsInvolved  Yes ;GLA are low tech
End

Behavior  SlowDeathBehavior ModuleTag_045
DeathTypes  ALL
DestructionDelay  1000
FX  INITIAL FX_GLADemoTrapWarning
OCL  FINAL OCL_CreateExplodedDemoTrap
Weapon  FINAL DemoTruckDemoTrapDetonationWeapon
End

Behavior  FireWeaponUpdate ModuleTag_20231
Weapon  DemoTruckDemoTrapGroundImpactEffect
InitialDelay  363
End

Behavior  StatusBitsUpgrade ModuleTag_NoSelect01
TriggeredBy     Upgrade_CostReduction
StatusToSet     UNSELECTABLE
End

Behavior  FlammableUpdate ModuleTag_047
AflameDuration  5000         ; If I catch fire, I'll burn for this long...
AflameDamageAmount  5       ; taking this much damage...
AflameDamageDelay  500       ; this often.
End

BuildCompletion  PLACED_BY_PLAYER
Shadow           SHADOW_VOLUME
Geometry  CYLINDER
GeometryMajorRadius  4.0
GeometryHeight  9
GeometryIsSmall  Yes

End