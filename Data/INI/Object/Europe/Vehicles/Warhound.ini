;------------------------------------------------------------------------------
Object EuropeTankWarhound

; *** ART Parameters ***
SelectPortrait          SEWarhound_L
ButtonImage             SEWarhound

Draw  W3DTankDraw ModuleTag_01

OkToChangeModelColor  Yes
MaxRecoilDistance     1.0
ParticlesAttachedToAnimatedBones  Yes

;Normal Mobile State
DefaultConditionState
Model              EVAvre
Animation          EVAvre_SKL.EVAvre_MVA
AnimationMode      ONCE_BACKWARDS
Flags              START_FRAME_LAST
Turret             Turret
HideSubObject      GASGUN01 SKIRT01
WeaponFireFXBone   SECONDARY MzzlMG
WeaponLaunchBone   SECONDARY MzzlMG
WeaponMuzzleFlash  SECONDARY MuzzleFX
WeaponMuzzleFlash  TERTIARY MzzlMGFX
TransitionKey      TRANS_MOBILE
End
AliasConditionState  RIDER1

;Mobile Moving State
ConditionState        RIDER1 MOVING
Animation          EVAvre_SKL.EVAvre_MVA
AnimationMode      ONCE
Flags              START_FRAME_FIRST
Turret             Turret
WeaponFireFXBone   SECONDARY MzzlMG
WeaponLaunchBone   SECONDARY MzzlMG
WeaponMuzzleFlash  SECONDARY MuzzleFX
WeaponMuzzleFlash  TERTIARY MzzlMGFX
TransitionKey      TRANS_MOVING
End

;Immobile dugin State
ConditionState       RIDER2
Animation          EVAvre_SKL.EVAvre_DGA
AnimationMode      ONCE
TurretPitch        TurretEL
WeaponRecoilBone   SECONDARY Barrel
WeaponFireFXBone   SECONDARY Muzzle
WeaponLaunchBone   SECONDARY Muzzle
WeaponMuzzleFlash  SECONDARY MuzzleFX
WeaponMuzzleFlash  TERTIARY MzzlMGFX
Flags              START_FRAME_LAST PRISTINE_BONE_POS_IN_FINAL_FRAME
TransitionKey      TRANS_IMMOBILE
End
AliasConditionState  RIDER2 MOVING

;Placing demo charge State
ConditionState        RIDER1 UNPACKING
Animation          EVAvre_SKL.EVAvre_BDC
AnimationMode      ONCE
Flags              START_FRAME_FIRST
WeaponFireFXBone   PRIMARY MzzlMG
WeaponLaunchBone   PRIMARY MzzlMG
WeaponMuzzleFlash  TERTIARY MuzzleFX
TransitionKey      TRANS_DIGGING_BOMB
ParticleSysBone    BLADEDUST DozerDirtFall_Permanent
End

;Finished placing demo charge State
TransitionState       TRANS_DIGGING_BOMB TRANS_MOBILE
Animation          EVAvre_SKL.EVAvre_BDD
AnimationMode      ONCE_BACKWARDS
Flags              START_FRAME_LAST
WeaponFireFXBone   PRIMARY MzzlMG
WeaponLaunchBone   PRIMARY MzzlMG
WeaponMuzzleFlash  TERTIARY MuzzleFX
ParticleSysBone    BLADEDUST DozerDirtFall
End

TransitionState       TRANS_DIGGING_BOMB TRANS_MOVING
Animation          EVAvre_SKL.EVAvre_BDD
AnimationMode      ONCE_BACKWARDS
Flags              START_FRAME_LAST
WeaponFireFXBone   PRIMARY MzzlMG
WeaponLaunchBone   PRIMARY MzzlMG
WeaponMuzzleFlash  TERTIARY MuzzleFX
ParticleSysBone    BLADEDUST DozerDirtFall
End

;Transitions between mobile and immobile modes
TransitionState      TRANS_DIGGING_BOMB TRANS_IMMOBILE
Animation          EVAvre_SKL.EVAvre_DGA
AnimationMode      ONCE
TurretPitch        TurretEL
Flags              START_FRAME_FIRST PRISTINE_BONE_POS_IN_FINAL_FRAME
ParticleSysBone    BLADEDUST DozerDirtFall
End

TransitionState      TRANS_MOBILE TRANS_IMMOBILE
Animation          EVAvre_SKL.EVAvre_DGA
AnimationMode      ONCE
TurretPitch        TurretEL
Flags              START_FRAME_FIRST PRISTINE_BONE_POS_IN_FINAL_FRAME
ParticleSysBone    BLADEDUST DozerDirtFall
End

TransitionState      TRANS_IMMOBILE TRANS_MOBILE
Animation          EVAvre_SKL.EVAvre_DGB
AnimationMode      ONCE
Flags              START_FRAME_FIRST PRISTINE_BONE_POS_IN_FINAL_FRAME
End

TransitionState      TRANS_MOVING TRANS_IMMOBILE
Animation          EVAvre_SKL.EVAvre_DGA
AnimationMode      ONCE
TurretPitch        TurretEL
Flags              START_FRAME_FIRST PRISTINE_BONE_POS_IN_FINAL_FRAME
ParticleSysBone    BLADEDUST DozerDirtFall
End

TransitionState      TRANS_IMMOBILE TRANS_MOVING
Animation          EVAvre_SKL.EVAvre_DGC
AnimationMode      ONCE
Flags              START_FRAME_FIRST PRISTINE_BONE_POS_IN_FINAL_FRAME
End

;Reallydamaged conditions

;Normal Mobile State
ConditionState       REALLYDAMAGED RIDER1
Model              EVAvre_D
Animation          EVAvre_SKL.EVAvre_MVA
AnimationMode      ONCE_BACKWARDS
Flags              START_FRAME_LAST
Turret             Turret
HideSubObject      GASGUN01 SKIRT01
WeaponFireFXBone   SECONDARY MzzlMG
WeaponLaunchBone   SECONDARY MzzlMG
WeaponMuzzleFlash  SECONDARY MuzzleFX
WeaponMuzzleFlash  TERTIARY MzzlMGFX
TransitionKey      TRANS_DAMAGED_MOBILE
End
AliasConditionState  RUBBLE RIDER1

;Mobile Moving State
ConditionState        REALLYDAMAGED RIDER1 MOVING
Model              EVAvre_D
Animation          EVAvre_SKL.EVAvre_MVA
AnimationMode      ONCE
Flags              START_FRAME_FIRST
Turret             Turret
WeaponFireFXBone   SECONDARY MzzlMG
WeaponLaunchBone   SECONDARY MzzlMG
WeaponMuzzleFlash  SECONDARY MuzzleFX
WeaponMuzzleFlash  TERTIARY MzzlMGFX
TransitionKey      TRANS_DAMAGED_MOVING
End

;Immobile dugin State
ConditionState       REALLYDAMAGED RIDER2
Model              EVAvre_D
Animation          EVAvre_SKL.EVAvre_DGA
AnimationMode      ONCE
TurretPitch        TurretEL
WeaponRecoilBone   SECONDARY Barrel
WeaponFireFXBone   SECONDARY Muzzle
WeaponLaunchBone   SECONDARY Muzzle
WeaponMuzzleFlash  SECONDARY MuzzleFX
WeaponMuzzleFlash  TERTIARY MzzlMGFX
Flags              START_FRAME_LAST PRISTINE_BONE_POS_IN_FINAL_FRAME
TransitionKey      TRANS_DAMAGED_IMMOBILE
End
AliasConditionState  REALLYDAMAGED RIDER2 MOVING
AliasConditionState  RUBBLE RIDER2

;Placing demo charge State
ConditionState        REALLYDAMAGED RIDER1 UNPACKING
Model              EVAvre_D
Animation          EVAvre_SKL.EVAvre_BDC
AnimationMode      ONCE
Flags              START_FRAME_FIRST
WeaponFireFXBone   PRIMARY MzzlMG
WeaponLaunchBone   PRIMARY MzzlMG
WeaponMuzzleFlash  TERTIARY MuzzleFX
TransitionKey      TRANS_DAMAGED_DIGGING_BOMB
ParticleSysBone    BLADEDUST DozerDirtFall_Permanent
End

;Finished placing demo charge State
TransitionState       TRANS_DAMAGED_DIGGING_BOMB TRANS_DAMAGED_MOBILE
Model              EVAvre_D
Animation          EVAvre_SKL.EVAvre_BDD
AnimationMode      ONCE_BACKWARDS
Flags              START_FRAME_LAST
WeaponFireFXBone   PRIMARY MzzlMG
WeaponLaunchBone   PRIMARY MzzlMG
WeaponMuzzleFlash  TERTIARY MuzzleFX
ParticleSysBone    BLADEDUST DozerDirtFall
End

TransitionState       TRANS_DAMAGED_DIGGING_BOMB TRANS_DAMAGED_MOVING
Model              EVAvre_D
Animation          EVAvre_SKL.EVAvre_BDD
AnimationMode      ONCE_BACKWARDS
Flags              START_FRAME_LAST
WeaponFireFXBone   PRIMARY MzzlMG
WeaponLaunchBone   PRIMARY MzzlMG
WeaponMuzzleFlash  TERTIARY MuzzleFX
ParticleSysBone    BLADEDUST DozerDirtFall
End

;Transitions between mobile and immobile modes
TransitionState      TRANS_DAMAGED_DIGGING_BOMB TRANS_DAMAGED_IMMOBILE
Model              EVAvre_D
Animation          EVAvre_SKL.EVAvre_DGA
AnimationMode      ONCE
TurretPitch        TurretEL
Flags              START_FRAME_FIRST PRISTINE_BONE_POS_IN_FINAL_FRAME
ParticleSysBone    BLADEDUST DozerDirtFall
End

TransitionState      TRANS_DAMAGED_MOBILE TRANS_DAMAGED_IMMOBILE
Model              EVAvre_D
Animation          EVAvre_SKL.EVAvre_DGA
AnimationMode      ONCE
TurretPitch        TurretEL
Flags              START_FRAME_FIRST PRISTINE_BONE_POS_IN_FINAL_FRAME
ParticleSysBone    BLADEDUST DozerDirtFall
End

TransitionState      TRANS_DAMAGED_IMMOBILE TRANS_DAMAGED_MOBILE
Model              EVAvre_D
Animation          EVAvre_SKL.EVAvre_DGB
AnimationMode      ONCE
Flags              START_FRAME_FIRST PRISTINE_BONE_POS_IN_FINAL_FRAME
End

TransitionState      TRANS_DAMAGED_MOVING TRANS_DAMAGED_IMMOBILE
Model              EVAvre_D
Animation          EVAvre_SKL.EVAvre_DGA
AnimationMode      ONCE
TurretPitch        TurretEL
Flags              START_FRAME_FIRST PRISTINE_BONE_POS_IN_FINAL_FRAME
ParticleSysBone    BLADEDUST DozerDirtFall
End

TransitionState      TRANS_DAMAGED_IMMOBILE TRANS_DAMAGED_MOVING
Model              EVAvre_D
Animation          EVAvre_SKL.EVAvre_DGC
AnimationMode      ONCE
Flags              START_FRAME_FIRST PRISTINE_BONE_POS_IN_FINAL_FRAME
End

TrackMarks               EXTnkTrack.tga
TreadAnimationRate       2.0  ; amount of tread texture to move per second
TreadDriveSpeedFraction  0.3  ; fraction of locomotor speed below which treads stop moving.
TreadPivotSpeedFraction  0.6  ; fraction of locomotor speed below which we allow pivoting.
End

Draw                       W3DModelDraw ModuleTag_DirtPatch01
DefaultConditionState
Model                NONE
TransitionKey        TRANS_MOBILE
End
AliasConditionState  RIDER1

;Transitions between modes
TransitionState        TRANS_MOBILE TRANS_IMMOBILE
Model                EVAvre_Dirt
Animation            EVAvre_Dirt.EVAvre_Dirt
AnimationMode        ONCE
Flags                START_FRAME_FIRST
End
TransitionState        TRANS_IMMOBILE TRANS_MOBILE
Model                EVAvre_Dirt
Animation            EVAvre_Dirt.EVAvre_Dirt
AnimationMode        ONCE_BACKWARDS
Flags                START_FRAME_LAST
AnimationSpeedFactorRange  1.5 1.5
End

;Dugin Conditions
ConditionState         RIDER2
Model                EVAvre_Dirt
Animation            EVAvre_Dirt.EVAvre_Dirt
AnimationMode        ONCE
Flags                START_FRAME_LAST
TransitionKey        TRANS_IMMOBILE
End
ConditionState         REALLYDAMAGED
Model                NONE
TransitionKey        TRANS_DAMAGED_MOBILE
End
AliasConditionState  REALLYDAMAGED RIDER1

;Transitions between modes
TransitionState        TRANS_DAMAGED_MOBILE TRANS_DAMAGED_IMMOBILE
Model                EVAvre_Dirt_D
Animation            EVAvre_Dirt_D.EVAvre_Dirt_D
AnimationMode        ONCE
Flags                START_FRAME_FIRST
End
TransitionState        TRANS_DAMAGED_IMMOBILE TRANS_DAMAGED_MOBILE
Model                EVAvre_Dirt_D
Animation            EVAvre_Dirt_D.EVAvre_Dirt_D
AnimationMode        ONCE_BACKWARDS
Flags                START_FRAME_LAST
AnimationSpeedFactorRange  1.5 1.5
End

;Dugin Conditions
ConditionState         REALLYDAMAGED RIDER2
Model                EVAvre_Dirt_D
Animation            EVAvre_Dirt_D.EVAvre_Dirt_D
AnimationMode        ONCE
Flags                START_FRAME_LAST
TransitionKey        TRANS_DAMAGED_IMMOBILE
End
ConditionState         SNOW
Model                NONE
TransitionKey        TRANS_SNOW_MOBILE
End
AliasConditionState  SNOW RIDER1

;Transitions between modes
TransitionState        TRANS_SNOW_MOBILE TRANS_SNOW_IMMOBILE
Model                EVAvre_Dirt_S
Animation            EVAvre_Dirt_S.EVAvre_Dirt_S
AnimationMode        ONCE
Flags                START_FRAME_FIRST
End
TransitionState        TRANS_SNOW_IMMOBILE TRANS_SNOW_MOBILE
Model                EVAvre_Dirt_S
Animation            EVAvre_Dirt_S.EVAvre_Dirt_S
AnimationMode        ONCE_BACKWARDS
Flags                START_FRAME_LAST
AnimationSpeedFactorRange  1.5 1.5
End

;Dugin Conditions
ConditionState         SNOW RIDER2
Model                EVAvre_Dirt_S
Animation            EVAvre_Dirt_S.EVAvre_Dirt_S
AnimationMode        ONCE
Flags                START_FRAME_LAST
TransitionKey        TRANS_SNOW_IMMOBILE
End
ConditionState         SNOW REALLYDAMAGED
Model                NONE
TransitionKey        TRANS_DAMAGED_SNOW_MOBILE
End
AliasConditionState  SNOW REALLYDAMAGED RIDER1

;Transitions between modes
TransitionState        TRANS_DAMAGED_SNOW_MOBILE TRANS_DAMAGED_SNOW_IMMOBILE
Model                EVAvre_Dirt_SD
Animation            EVAvre_Dirt_SD.EVAvre_Dirt_SD
AnimationMode        ONCE
Flags                START_FRAME_FIRST
End
TransitionState        TRANS_DAMAGED_SNOW_IMMOBILE TRANS_DAMAGED_SNOW_MOBILE
Model                EVAvre_Dirt_SD
Animation            EVAvre_Dirt_SD.EVAvre_Dirt_SD
AnimationMode        ONCE_BACKWARDS
Flags                START_FRAME_LAST
AnimationSpeedFactorRange  1.5 1.5
End

;Dugin Conditions
ConditionState         SNOW REALLYDAMAGED RIDER2
Model                EVAvre_Dirt_SD
Animation            EVAvre_Dirt_SD.EVAvre_Dirt_SD
AnimationMode        ONCE
Flags                START_FRAME_LAST
TransitionKey        TRANS_DAMAGED_SNOW_IMMOBILE
End

End

; ***DESIGN parameters ***
DisplayName            OBJECT:Warhound
Side                   Europe
EditorSorting          VEHICLE
TransportSlotCount     3                 ;how many "slots" we take in a transport (0 == not transportable)

WeaponSet
Conditions  WEAPON_RIDER1
Weapon               SECONDARY WarhoundMachinegunWeapon
End
WeaponSet
Conditions  WEAPON_RIDER2
Weapon               PRIMARY   WarhoundMortarCannonDummyWeapon
AutoChooseSources    PRIMARY   NONE
Weapon               SECONDARY WarhoundMortarCannonWeapon
End

;Upgraded Weaponsets

WeaponSet
Conditions  PLAYER_UPGRADE WEAPON_RIDER1
Weapon               SECONDARY WarhoundMachinegunWeapon
End
WeaponSet
Conditions  PLAYER_UPGRADE WEAPON_RIDER2
Weapon               PRIMARY   WarhoundMortarCannonDummyUpgradedWeapon
AutoChooseSources    PRIMARY   NONE
Weapon               SECONDARY WarhoundMortarCannonUpgradedWeapon
End

ArmorSet
Conditions       None
Armor            WarhoundTankArmor
DamageFX         TankDamageFX
End

Prerequisites
Object  EuropeFieldCommand
End

BuildCost        1000
BuildTime        10.0          ;in seconds
VisionRange      360
ShroudClearingRange  400

ExperienceValue     80 80 150 300    ;Experience point value at each level
ExperienceRequired  0 200 300 600    ;Experience points needed to gain each level
IsTrainable  Yes             ;Can gain experience
CrusherLevel            2  ;What can I crush?: 1  infantry, 2  trees, 3  vehicles
CrushableLevel          2  ;What am I?:        0  for infantry, 1  for trees, 2  general vehicles

; *** AUDIO Parameters ***
VoiceSelect            WarhoundVoiceSelect
VoiceMove              WarhoundVoiceMove
VoiceGuard             WarhoundVoiceMove
VoiceAttack            WarhoundVoiceAttack
SoundMoveStart         WarhoundMoveStart
SoundMoveStartDamaged  WarhoundMoveStart

UnitSpecificSounds
VoiceCreate          WarhoundVoiceCreate
VoiceCrush           WarhoundVoiceMove
VoiceEnter           WarhoundVoiceMove
End

; *** ENGINEERING Parameters ***
RadarPriority  UNIT
KindOf  PRELOAD SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_CAST_REFLECTIONS VEHICLE SCORE TRANSPORT FS_BASE_DEFENSE CANNOT_RETALIATE SALVAGER

Body  ActiveBody ModuleTag_02
MaxHealth        400.0
InitialHealth    400.0

; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
SubdualDamageCap  1200
SubdualDamageHealRate  500
SubdualDamageHealAmount  50
End

Behavior  TransportAIUpdate ModuleTag_03
Turret
ControlledWeaponSlots  PRIMARY SECONDARY
TurretTurnRate         30
TurretPitchRate        30
FirePitch              20
AllowsPitch            Yes
MinIdleScanAngle       10
MaxIdleScanAngle       40
MinIdleScanInterval    5000
MaxIdleScanInterval    10000
End
TurretsLinked  Yes
AutoAcquireEnemiesWhenIdle  Yes
MoodAttackCheckRate  33
End
Locomotor  SET_NORMAL WarhoundLocomotor
Locomotor  SET_SUPERSONIC GuardianDroneDugInLocomotor

Behavior  PhysicsBehavior ModuleTag_04
Mass  50.0
End

Behavior  SpecialAbility ModuleTag_DemoCharge01
SpecialPowerTemplate      SpecialAbilityWarhoundDemolitionCharge
UpdateModuleStartsAttack  Yes
StartsPaused              No                 ; so the UnpauseSpecialPowerUpgrade, below can turn it on
InitiateSound             WarhoundVoicePlaceDemolitionCharge
End

Behavior  SpecialAbilityUpdate ModuleTag_DemoCharge02
SpecialPowerTemplate                SpecialAbilityWarhoundDemolitionCharge
StartAbilityRange                   5.0
PreparationTime                     0
SpecialObjectAttachToBone           WeaponA01
SpecialObject                       WarhoundDemolitionChargeSpawnerObject
MaxSpecialObjects                   5
SpecialObjectsPersistWhenOwnerDies  Yes
SpecialObjectsPersistent            Yes
UniqueSpecialObjectTargets          No
UnpackTime                          9000
FlipOwnerAfterUnpacking             No
FleeRangeAfterCompletion            150.0     ;Dees not run away after finishing ability
LoseStealthOnTrigger                No
ApproachRequiresLOS                 No      ; we are a helicopter, we can see everything
NeedToFaceTarget                    Yes
End

;*************************************
;******Transformation Code Start******
;*************************************

Behavior  RiderChangeContain ModuleTag_Transform01

;Standard mode
Rider1  GenericFakeRider1_Default_Rank RIDER1 WEAPON_RIDER1 STATUS_RIDER1 EuropeTankWarhoundMobileCommandSet SET_NORMAL

;Dugin mode
Rider2  GenericFakeRider2_Default_Rank RIDER2 WEAPON_RIDER2 STATUS_RIDER2 EuropeTankWarhoundDuginCommandSet  SET_SUPERSONIC

;Standard mode Dummy Mode
Rider3  GenericFakeRider3_Default_Rank RIDER1 WEAPON_RIDER1 STATUS_RIDER1 EuropeTankWarhoundMobileAlternativeCommandset SET_NORMAL

;Dugin mode Dummy Mode
Rider4  GenericFakeRider4_Default_Rank RIDER2 WEAPON_RIDER2 STATUS_RIDER2 EuropeTankWarhoundDuginAlternativeCommandSet  SET_SUPERSONIC

;We start with this rider then once the timer on module "ModuleTag_Transform04" runs out we switch to rider 4 and never use this again.
Rider5  GenericFakeRider5_Default_Rank RIDER1 WEAPON_RIDER1 STATUS_RIDER1 EuropeTankWarhoundMobileDummyCommandset SET_NORMAL


;Standard TransportContain stuff
Slots                  1
InitialPayload         GenericFakeRider5_Default_Rank 1
DamagePercentToUnits   100%
BurnedDeathToUnits     No
AllowInsideKindOf      CAN_ATTACK
ScuttleDelay           100
ScuttleStatus          TOPPLED
End

Behavior  ProductionUpdate  ModuleTag_Transform02
MaxQueueEntries  1; So you can't build multiple upgrades in the same frame
End

Behavior  BoneFXDamage ModuleTag_Transform21
End

Behavior  BoneFXUpdate ModuleTag_Transform03
;General collision effect
PristineOCL1       bone:NULL OnlyOnce:No 0 0 OCL:OCL_GenericCollisionObjectDummy
DamagedOCL1        bone:NULL OnlyOnce:No 0 0 OCL:OCL_GenericCollisionObjectDummy
ReallyDamagedOCL1  bone:NULL OnlyOnce:No 0 0 OCL:OCL_GenericCollisionObjectDummy
End

;the initial rider disables all abilities (safe fore the demolition charge) but after timer on this module expires it switches to a different one.
Behavior  FireWeaponUpdate ModuleTag_Transform04
Weapon  WarhoundSwitchToMobileModeAlternative
InitialDelay  6000
End

;This module is required to make the dummy buttons unaccesable and nothing more than that.
Behavior  ObjectCreationUpgrade ModuleTag_Transform05
TriggeredBy    Upgrade_GLAWorkerWorthlessCommandSet
ConflictsWith  Upgrade_CostReduction
UpgradeObject  OCL_RussiaTargetingSatelliteTimerDummy
End

;this status is purely required for when this unit rolls out of the factory to disable some triggers from breaking things.
Behavior  StatusBitsUpgrade ModuleTag_Transform06
TriggeredBy    Upgrade_CostReduction
StatusToSet    STATUS_RIDER6
End

;this is a module using the above status to trigger once the Warhound is dugin
Behavior  FireWeaponCollide  ModuleTag_Transform07
CollideWeapon    WarhoundSwitchToDiginModeAlternative
RequiredStatus   STATUS_RIDER6 STATUS_RIDER1 STATUS_RIDER7
End

;this module triggers a timer 6 seconds after being dugin to enable the undig button but only does this once.
;afterwards the modules below are used for everything and these are no longer used.
Behavior  FireWeaponCollide  ModuleTag_Transform08
CollideWeapon    WarhoundSwitchToDiginMode
RequiredStatus   STATUS_RIDER6 STATUS_RIDER2 STATUS_RIDER7 USING_ABILITY
ForbiddenStatus  STATUS_RIDER4
End

;Primary Unit Mode Triggers

Behavior  FireWeaponCollide ModuleTag_Transform09
CollideWeapon    WarhoundSwitchToMobileMode
RequiredStatus   STATUS_RIDER2 STATUS_RIDER8
End

Behavior  ObjectCreationUpgrade ModuleTag_Transform10
UpgradeObject    OCL_WarhoundMobileMode
TriggeredBy      Upgrade_GLAWorkerRealCommandSet
FXListUpgrade    FX_GuardianDronePopoutofGround
RequiresAllTriggers  Yes
End

Behavior  StatusBitsUpgrade ModuleTag_Transform11
TriggeredBy    Upgrade_GLAWorkerRealCommandSet
StatusToSet    STATUS_RIDER8
StatusToClear  STATUS_RIDER7
End

Behavior  StatusBitsUpgrade ModuleTag_Transform12
TriggeredBy    Upgrade_GLAWorkerRealCommandSet
StatusToSet    STATUS_RIDER4
StatusToClear  STATUS_RIDER6
End

Behavior  MaxHealthUpgrade ModuleTag_Transform13
TriggeredBy    Upgrade_GLAWorkerRealCommandSet
AddMaxHealth   -400.0 ; And remove them when i come back out
ChangeType     PRESERVE_RATIO
End

;Secondary Unit Mode Triggers

Behavior  FireWeaponCollide  ModuleTag_Transform14
CollideWeapon    WarhoundSwitchToDiginMode
RequiredStatus   STATUS_RIDER1 STATUS_RIDER7
ForbiddenStatus  STATUS_RIDER6
End

Behavior  ObjectCreationUpgrade ModuleTag_Transform15
UpgradeObject    OCL_WarhoundDuginMode
TriggeredBy      Upgrade_GLAWorkerFakeCommandSet
FXListUpgrade    FX_GuardianDroneDigInGround
RequiresAllTriggers  No
End

Behavior  StatusBitsUpgrade ModuleTag_Transform16
TriggeredBy    Upgrade_GLAWorkerFakeCommandSet
StatusToSet    STATUS_RIDER7
StatusToClear  STATUS_RIDER8
End

Behavior  MaxHealthUpgrade ModuleTag_Transform17
TriggeredBy    Upgrade_GLAWorkerFakeCommandSet
AddMaxHealth   400.0 ; Give me 400 more hit points when dug in
ChangeType     PRESERVE_RATIO
RequiresAllTriggers  No
End

;Additional Triggers and Upgrades

Behavior  FireWeaponCollide ModuleTag_Transform18
CollideWeapon   WarhoundRepairAuraWeapon
RequiredStatus  STATUS_RIDER2
End

Behavior  FireWeaponCollide ModuleTag_Transform19
CollideWeapon   WarhoundRepairDecalWeapon
RequiredStatus  STATUS_RIDER2
End

Behavior  FireWeaponCollide ModuleTag_Transform20
CollideWeapon   WarhoundRemoveDemoChargeWhenDuginWeapon
RequiredStatus  STATUS_RIDER2
End

;************************************
;******Transformation Code End*******
;************************************

Behavior  SubObjectsUpgrade ModuleTag_ArmorSkirt01
TriggeredBy     Upgrade_EuropeArmorSkirts
ShowSubObjects  SKIRT01
End

Behavior  MaxHealthUpgrade ModuleTag_ArmorSkirt02
TriggeredBy    Upgrade_EuropeArmorSkirts
AddMaxHealth   100.0
ChangeType     ADD_CURRENT_HEALTH_TOO
End

Behavior  CreateCrateDie ModuleTag_07
CrateData  SalvageCrateData
End

Behavior                  TransitionDamageFX ModuleTag_08
ReallyDamagedParticleSystem1  Bone:Smoke RandomBone:Yes PSys:SmallLightSmokeColumn
ReallyDamagedFXList1  Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
End

Behavior  FlammableUpdate ModuleTag_21
AflameDuration  5000         ; If I catch fire, I'll burn for this long...
AflameDamageAmount  3       ; taking this much damage...
AflameDamageDelay  500       ; this often.
End

Behavior  WeaponSetUpgrade ModuleTag_GasIgnition01
TriggeredBy  Upgrade_EuropeGasIgnitionGuns
End

Behavior  SubObjectsUpgrade ModuleTag_GasIgnition02
TriggeredBy     Upgrade_EuropeGasIgnitionGuns
ShowSubObjects  GASGUN01
End

Behavior  PointDefenseLaserUpdate ModuleTag_AntiPersonnelGrenade01
WeaponTemplate         EuropeVehicleAntiPersonnelGrenadeLaunchWeapon
PrimaryTargetTypes     INFANTRY
ScanRate               600
ScanRange              80.0
PredictTargetVelocityFactor  3.0
End

Behavior  StealthUpdate ModuleTag_GPSStealth01
StealthDelay                 2000 ; msec
StealthForbiddenConditions   FIRING_PRIMARY FIRING_SECONDARY FIRING_TERTIARY RIDERS_ATTACKING
InnateStealth                Yes
RequiredStatus               REASSIGN_PARKING ;Used exclusively by the GPS Scrambler
OrderIdleEnemiesToAttackMeUponReveal   Yes
End

Behavior  SlowDeathBehavior ModuleTag_Death01
RequiredStatus  STATUS_RIDER1
DeathTypes  ALL -CRUSHED -SPLATTED -TOPPLED -EXTRA_7
DestructionDelay  33
FX   INITIAL  FX_CrusaderCatchFire
FX   FINAL    FX_GenericTankDeathExplosion
OCL  FINAL    OCL_EuropeTankWarhoundDebris
End

Behavior  SlowDeathBehavior ModuleTag_Death02
RequiredStatus  STATUS_RIDER2
DeathTypes  ALL -CRUSHED -SPLATTED -TOPPLED -EXTRA_7
DestructionDelay  33
FX   INITIAL  FX_CrusaderCatchFire
FX   FINAL    FX_GenericTankDeathExplosion
OCL  FINAL    OCL_EuropeTankWarhoundDuginDebris
End

Behavior  DestroyDie ModuleTag_11
DeathTypes  NONE +CRUSHED +SPLATTED +TOPPLED +EXTRA_7
End

Behavior  FXListDie ModuleTag_09
DeathTypes  NONE +CRUSHED +SPLATTED -TOPPLED -EXTRA_7
DeathFX  FX_CarCrush
End

Behavior  EjectPilotDie ModuleTag_HijackerEmerge01
DeathTypes  ALL -CRUSHED -SPLATTED -TOPPLED -EXTRA_7
RequiredStatus  HIJACKED
VeterancyLevels   ALL
GroundCreationList  OCL_HijackerEmerge
AirCreationList  OCL_HijackerEmergeViaParachute
End

Behavior  FXListDie ModuleTag_HijackerEmerge02
RequiredStatus  HIJACKED
DeathTypes  ALL -CRUSHED -SPLATTED -TOPPLED -EXTRA_7
DeathFX  FX_HijackerEmerge
End

Behavior  CreateObjectDie ModuleTag_1052352412
DeathTypes  NONE +TOPPLED +EXTRA_7
ExemptStatus  STATUS_RIDER2
CreationList  OCL_WarhoundNerveGasKill
TransferPreviousHealth  Yes
End

Behavior  CreateObjectDie ModuleTag_105235
DeathTypes  NONE +TOPPLED +EXTRA_7
ExemptStatus  STATUS_RIDER1
CreationList  OCL_WarhoundDuginNerveGasKill
TransferPreviousHealth  Yes
End

Geometry                BOX
GeometryMajorRadius     18.0
GeometryMinorRadius     10.0
GeometryHeight          10.0
GeometryIsSmall         Yes
Shadow  SHADOW_VOLUME
ShadowSizeX  45  ; minimum elevation angle above horizon. Used to limit shadow length

End

;------------------------------------------------------------------------------
Object WarhoundDeployedStructureDummyCollision

; ***DESIGN parameters ***
Side                 Europe
EditorSorting        SYSTEM

ArmorSet
Conditions         None
Armor              InvulnerableArmorAll
DamageFX           DamageFX_Empty
End

; *** ENGINEERING Parameters ***
KindOf                PRELOAD IMMOBILE CAN_SEE_THROUGH_STRUCTURE STICK_TO_TERRAIN_SLOPE UNATTACKABLE NO_COLLIDE

Body                  StructureBody ModuleTag_05
MaxHealth           600.0
InitialHealth       600.0
End

Behavior  DeletionUpdate ModuleTag_032512
MinLifetime  66
MaxLifetime  66
End

Behavior  DestroyDie ModuleTag_11
End

Geometry              BOX
GeometryMajorRadius   19.0
GeometryMinorRadius   11.0
GeometryHeight        5.0
GeometryIsSmall       No
Shadow                SHADOW_VOLUME
BuildCompletion       PLACED_BY_PLAYER

End

;------------------------------------------------------------------------------
Object EuropeTankWarhoundUnmanned

; *** ART Parameters ***
SelectPortrait          SEWarhound_L
ButtonImage             SEWarhound

UpgradeCameo1  Upgrade_EuropeGasIgnitionGuns
UpgradeCameo2  Upgrade_EuropeClusterMunitions
UpgradeCameo3  Upgrade_EuropeArmorSkirts
;UpgradeCameo4  NONE
;UpgradeCameo5  NONE

Draw  W3DTankDraw ModuleTag_01

OkToChangeModelColor  Yes
MaxRecoilDistance     1.0
ParticlesAttachedToAnimatedBones  Yes

DefaultConditionState
Model              EVAvre
Animation          EVAvre_SKL.EVAvre_MVA
AnimationMode      ONCE
Flags              START_FRAME_LAST
Turret             Turret
WeaponFireFXBone   SECONDARY MzzlMG
WeaponLaunchBone   SECONDARY MzzlMG
WeaponMuzzleFlash  SECONDARY MzzlMGFX
WeaponMuzzleFlash  TERTIARY  MuzzleFX
End
AliasConditionState  NIGHT

ConditionState  REALLYDAMAGED
Model              EVAvre_D
Animation          EVAvre_SKL.EVAvre_MVA
AnimationMode      ONCE
Flags              START_FRAME_LAST
Turret             Turret
WeaponFireFXBone   SECONDARY MzzlMG
WeaponLaunchBone   SECONDARY MzzlMG
WeaponMuzzleFlash  SECONDARY MzzlMGFX
WeaponMuzzleFlash  TERTIARY  MuzzleFX
End
AliasConditionState  REALLYDAMAGED NIGHT

End

; ***DESIGN parameters ***
DisplayName             OBJECT:Warhound
Side                    Europe
EditorSorting           SYSTEM
TransportSlotCount      3


WeaponSet
Conditions            NONE
Weapon                PRIMARY   SuicideUnresistableWeapon
End

ArmorSet
Conditions            None
Armor                 TankArmor
DamageFX              UnmannedTankDamageFX
End

VisionRange             200
ShroudClearingRange  200


IsTrainable             No
CrusherLevel            2               ;What can I crush?: 1  infantry, 2  trees, 3  vehicles
CrushableLevel          2               ;What am I?:        0  for infantry, 1  for trees, 2  general vehicles

; *** ENGINEERING Parameters ***
RadarPriority           UNIT
KindOf                  PRELOAD SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_CAST_REFLECTIONS VEHICLE

Body                    ActiveBody ModuleTag_02
MaxHealth        200.0
InitialHealth    200.0

; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
SubdualDamageCap  600
SubdualDamageHealRate  500
SubdualDamageHealAmount  50
End

Behavior  AIUpdateInterface ModuleTag_03
AutoAcquireEnemiesWhenIdle  No
End
Locomotor             SET_NORMAL   FreeFallLocomotor

Behavior  PhysicsBehavior ModuleTag_04
Mass                  50.0
End

; Turret fly off death
Behavior  SlowDeathBehavior ModuleTag_10
DeathTypes  ALL -CRUSHED -SPLATTED -SUICIDED
DestructionDelay  100
DestructionDelayVariance  300
FX   INITIAL  FX_CrusaderCatchFire
FX   FINAL    FX_GenericTankDeathExplosion
OCL  FINAL    OCL_EuropeTankWarhoundDebris
End

Behavior  CreateCrateDie ModuleTag_salvage01
CrateData  SalvageCrateData
End

Behavior                  TransitionDamageFX ModuleTag_12
ReallyDamagedParticleSystem1  Bone:Smoke RandomBone:Yes PSys:SmallLightSmokeColumn
ReallyDamagedFXList1  Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
End

Behavior  DestroyDie ModuleTag_11
DeathTypes  NONE +CRUSHED +SPLATTED +SUICIDED
End

; A crushing defeat
Behavior  FXListDie ModuleTag_14
DeathTypes  NONE +CRUSHED +SPLATTED
DeathFX  FX_CarCrush
End

Behavior  FlammableUpdate ModuleTag_21
AflameDuration  5000         ; If I catch fire, I'll burn for this long...
AflameDamageAmount  3       ; taking this much damage...
AflameDamageDelay  500       ; this often.
End

Behavior        OCLUpdate ModuleTag_Respawn01 ; Context window is a reaction to this, no CommandSet
MinDelay      100
MaxDelay      100
CreateAtEdge  Yes ; as opposed to just creating on self

FactionTriggered  Yes ; This requires a controlling player before it works

FactionOCL    Faction:America                   OCL:OCL_SkyShieldShellExplosionDetonationEffect
FactionOCL    Faction:China                     OCL:OCL_SkyShieldShellExplosionDetonationEffect
FactionOCL    Faction:GLA                       OCL:OCL_SkyShieldShellExplosionDetonationEffect
FactionOCL    Faction:AmericaLaserGeneral       OCL:OCL_SkyShieldShellExplosionDetonationEffect
FactionOCL    Faction:AmericaSuperWeaponGeneral OCL:OCL_SkyShieldShellExplosionDetonationEffect
End

Behavior  CreateObjectDie ModuleTag_Respawn02
DeathTypes  NONE +SUICIDED
CreationList  OCL_WarhoundNerveGasKillRespawn
TransferPreviousHealth  Yes
End

Geometry                BOX
GeometryMajorRadius     18.0
GeometryMinorRadius     10.0
GeometryHeight          10.0
GeometryIsSmall         Yes
Shadow  SHADOW_VOLUME
ShadowSizeX  45

End

;------------------------------------------------------------------------------
Object EuropeTankWarhoundDugInUnmanned

; *** ART Parameters ***
SelectPortrait          SEWarhound_L
ButtonImage             SEWarhound

UpgradeCameo1  Upgrade_EuropeGasIgnitionGuns
UpgradeCameo2  Upgrade_EuropeClusterMunitions
UpgradeCameo3  Upgrade_EuropeArmorSkirts
;UpgradeCameo4  NONE
;UpgradeCameo5  NONE

Draw  W3DTankDraw ModuleTag_01

OkToChangeModelColor  Yes

DefaultConditionState
Model              EVAvre
Animation          EVAvre_SKL.EVAvre_DGB
AnimationMode      ONCE
Turret             Turret
WeaponFireFXBone   SECONDARY MzzlMG
WeaponLaunchBone   SECONDARY MzzlMG
WeaponMuzzleFlash  SECONDARY MzzlMGFX
WeaponMuzzleFlash  TERTIARY  MuzzleFX
End
AliasConditionState  NIGHT

ConditionState  REALLYDAMAGED
Model              EVAvre_D
End
AliasConditionState  REALLYDAMAGED NIGHT

End

Draw                       W3DModelDraw ModuleTag_DirtPatch01

ConditionState  NONE
Model                EVAvre_Dirt
Animation            EVAvre_Dirt.EVAvre_Dirt
AnimationMode        ONCE_BACKWARDS
Flags                START_FRAME_LAST
AnimationSpeedFactorRange  1.5 1.5
End

ConditionState         REALLYDAMAGED
Model                EVAvre_Dirt_D
Animation            EVAvre_Dirt_D.EVAvre_Dirt_D
AnimationMode        ONCE_BACKWARDS
Flags                START_FRAME_LAST
AnimationSpeedFactorRange  1.5 1.5
End

ConditionState         SNOW
Model                EVAvre_Dirt_S
Animation            EVAvre_Dirt_S.EVAvre_Dirt_S
AnimationMode        ONCE_BACKWARDS
Flags                START_FRAME_LAST
AnimationSpeedFactorRange  1.5 1.5
End

ConditionState         SNOW REALLYDAMAGED
Model                EVAvre_Dirt_SD
Animation            EVAvre_Dirt_SD.EVAvre_Dirt_SD
AnimationMode        ONCE_BACKWARDS
Flags                START_FRAME_LAST
AnimationSpeedFactorRange  1.5 1.5
End

End

; ***DESIGN parameters ***
DisplayName             OBJECT:Warhound
Side                    Europe
EditorSorting           SYSTEM
TransportSlotCount      3


WeaponSet
Conditions            NONE
Weapon                PRIMARY   SuicideUnresistableWeapon
End

ArmorSet
Conditions            None
Armor                 TankArmor
DamageFX              UnmannedTankDamageFX
End

VisionRange             200
ShroudClearingRange  200


IsTrainable             No
CrusherLevel            2               ;What can I crush?: 1  infantry, 2  trees, 3  vehicles
CrushableLevel          2               ;What am I?:        0  for infantry, 1  for trees, 2  general vehicles

; *** ENGINEERING Parameters ***
RadarPriority           UNIT
KindOf                  PRELOAD SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_CAST_REFLECTIONS VEHICLE

Body                    ActiveBody ModuleTag_02
MaxHealth        600.0
InitialHealth    600.0

; Subdual damage "Subdues" you (reaction defined by BodyModule) when it passes your max health.
; The cap limits how extra-subdued you can be, and the other numbers detemine how fast it drains away on its own.
SubdualDamageCap  600
SubdualDamageHealRate  500
SubdualDamageHealAmount  50
End

Behavior  AIUpdateInterface ModuleTag_03
AutoAcquireEnemiesWhenIdle  No
End
Locomotor             SET_NORMAL   FreeFallLocomotor

Behavior  PhysicsBehavior ModuleTag_04
Mass                  50.0
End

; Turret fly off death
Behavior  SlowDeathBehavior ModuleTag_10
DeathTypes  ALL -CRUSHED -SPLATTED -SUICIDED
DestructionDelay  100
DestructionDelayVariance  300
FX   INITIAL  FX_CrusaderCatchFire
FX   FINAL    FX_GenericTankDeathExplosion
OCL  FINAL    OCL_EuropeTankWarhoundDebris
End

Behavior  CreateCrateDie ModuleTag_salvage01
CrateData  SalvageCrateData
End

Behavior                  TransitionDamageFX ModuleTag_12
ReallyDamagedParticleSystem1  Bone:Smoke RandomBone:Yes PSys:SmallLightSmokeColumn
ReallyDamagedFXList1  Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
End

Behavior  DestroyDie ModuleTag_11
DeathTypes  NONE +CRUSHED +SPLATTED +SUICIDED
End

; A crushing defeat
Behavior  FXListDie ModuleTag_14
DeathTypes  NONE +CRUSHED +SPLATTED
DeathFX  FX_CarCrush
End

Behavior  FlammableUpdate ModuleTag_21
AflameDuration  5000         ; If I catch fire, I'll burn for this long...
AflameDamageAmount  3       ; taking this much damage...
AflameDamageDelay  500       ; this often.
End

Behavior        OCLUpdate ModuleTag_Respawn01 ; Context window is a reaction to this, no CommandSet
MinDelay      1000
MaxDelay      1000
CreateAtEdge  Yes ; as opposed to just creating on self

FactionTriggered  Yes ; This requires a controlling player before it works

FactionOCL    Faction:America                   OCL:OCL_SkyShieldShellExplosionDetonationEffect
FactionOCL    Faction:China                     OCL:OCL_SkyShieldShellExplosionDetonationEffect
FactionOCL    Faction:GLA                       OCL:OCL_SkyShieldShellExplosionDetonationEffect
FactionOCL    Faction:AmericaLaserGeneral       OCL:OCL_SkyShieldShellExplosionDetonationEffect
FactionOCL    Faction:AmericaSuperWeaponGeneral OCL:OCL_SkyShieldShellExplosionDetonationEffect
End

Behavior  CreateObjectDie ModuleTag_Respawn02
DeathTypes  NONE +SUICIDED
CreationList  OCL_WarhoundNerveGasKillRespawn
TransferPreviousHealth  No
End

Geometry                BOX
GeometryMajorRadius     18.0
GeometryMinorRadius     10.0
GeometryHeight          10.0
GeometryIsSmall         Yes
Shadow  SHADOW_VOLUME
ShadowSizeX  45

End